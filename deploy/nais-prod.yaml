apiVersion: nais.io/v1alpha1
kind: Application
metadata:
    name: rekrutteringsbistand-container
    namespace: toi
    labels:
        team: toi
spec:
    # prettier-ignore
    image: {{ image }}
    port: 8080
    ingresses:
        - https://rekrutteringsbistand.intern.nav.no
    liveness:
        initialDelay: 5
        path: /internal/isAlive
    readiness:
        initialDelay: 5
        path: /internal/isReady
    azure:
        application:
            enabled: true
            claims:
                extra:
                    - NAVident
        sidecar:
            enabled: true
    accessPolicy:
      outbound:
        external:
          - host: rekrutteringsbistand-statistikk-api.prod-fss-pub.nais.io
          - host: rekrutteringsbistand-stilling-api.prod-fss-pub.nais.io
    env:
        - name: NODE_EXTRA_CA_CERTS
          value: /etc/ssl/ca-bundle.pem
        - name: STATISTIKK_API_URL
          value: https://rekrutteringsbistand-statistikk-api.prod-fss-pub.nais.io/rekrutteringsbistand-statistikk-api
        - name: STILLINGSSOK_PROXY_URL
          value: https://rekrutteringsbistand-stillingssok-proxy.intern.nav.no
        - name: STILLING_API_URL
          value: https://rekrutteringsbistand-stilling-api.prod-fss-pub.nais.io
